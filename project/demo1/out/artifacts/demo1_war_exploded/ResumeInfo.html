<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/lib/css/elementUI_index.css">
    <link rel="stylesheet" href="/lib/css/ResumeInfo.css">
</head>
<body>
    <div id="app">
        <el-container class="main-box">
            <!--头部-->
            <el-header>
                <h1>Make Your Own Resume</h1>
            </el-header>
            <!--主体-->
            <el-container>
                <!--进度条-->
                <el-header style="height: auto">
                    <el-progress :percentage="progressBar.percentage" :color="progressBar.customColors"
                                 :stroke-width=12></el-progress>
                </el-header>
                <!--表单-->
                <el-main class="block">
                    <el-carousel :initial-index=0 trigger="click" :autoplay=false @change="changeProgress"
                                 :loop=false height="800">
                        <el-carousel-item v-for="item in 6" :key="item">
                            <!--basicInfo-->
                            <div v-if="formIndex===0">
                                <h1>BasicInfo</h1>
                                <el-form :model="resumeInfo.basicInfo" class="update_form" label-position="right"
                                         label-width="80px">
                                    <el-col :span=10>
                                        <el-form-item label="name">
                                            <el-input v-model="resumeInfo.basicInfo.name"
                                                      placeholder="name"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="job_profile">
                                            <el-input v-model="resumeInfo.basicInfo.job_profile"
                                                      placeholder="job_profile"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="phone">
                                            <el-input v-model="resumeInfo.basicInfo.phone"
                                                      placeholder="phone"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="email">
                                            <el-input v-model="resumeInfo.basicInfo.email"
                                                      placeholder="email"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="address">
                                            <el-input v-model="resumeInfo.basicInfo.address"
                                                      placeholder="address"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="national">
                                            <el-input v-model="resumeInfo.basicInfo.national"
                                                      placeholder="national"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="gender">
                                            <el-input v-model="resumeInfo.basicInfo.gender"
                                                      placeholder="gender"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="native_place">
                                            <el-input v-model="resumeInfo.basicInfo.native_place"
                                                      placeholder="native_place"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="age">
                                            <el-input v-model="resumeInfo.basicInfo.age"
                                                      placeholder="age"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=10>
                                        <el-form-item label="img">
                                            <el-input v-model="resumeInfo.basicInfo.img"
                                                      placeholder="img"></el-input>
                                        </el-form-item>
                                    </el-col>
                                </el-form>
                            </div>

                            <!--educationInfo-->
                            <div v-if="formIndex===1">
                                <h1>educationInfo</h1>
                                <el-form :model="resumeInfo.educationInfo" class="update_form" label-position="right"
                                         label-width="80px">
                                    <el-col :span=12>
                                        <el-form-item label="school">
                                            <el-input v-model="resumeInfo.educationInfo.school"
                                                      placeholder="school"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=12>
                                        <el-form-item label="profession">
                                            <el-input v-model="resumeInfo.educationInfo.profession"
                                                      placeholder="profession"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=12>
                                        <el-form-item label="record">
                                            <el-input v-model="resumeInfo.educationInfo.learning_record"
                                                      placeholder="learning_record"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=12>
                                        <el-form-item label="time">
                                            <el-input v-model="resumeInfo.educationInfo.learning_time"
                                                      placeholder="learning_time"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span=12>
                                        <el-form-item label="profile">
                                            <el-input type="textarea" placeholder="school profile"
                                                      v-model="resumeInfo.educationInfo.profile"
                                                      maxlength="300" show-word-limit></el-input>
                                        </el-form-item>
                                    </el-col>
                                </el-form>
                            </div>

                            <!--personalAbility-->
                            <div v-if="formIndex===2">
                                <h1>PersonalAbility</h1>
                                <el-form :model="resumeInfo.personalAbility" label-width="100px" class="demo-dynamic">
                                    <el-form-item v-for="(item, index) in resumeInfo.personalAbility" :key="index">
                                        <el-col :span="8">
                                            <el-form-item prop="name" label="能力概括">
                                                <el-input v-model="item.name"></el-input>
                                            </el-form-item>
                                        </el-col>
                                        <el-col :span="8">
                                            <el-form-item label="description">
                                                <el-input type="textarea" placeholder="description"
                                                          v-model="item.description"
                                                          maxlength="300" show-word-limit></el-input>
                                            </el-form-item>
                                        </el-col>
                                        <el-col :span="2" style="margin-left: 4rem">
                                            <el-button type="danger" @click.prevent="removeDomain(item)">删除</el-button>
                                        </el-col>
                                    </el-form-item>
                                    <el-form-item>
                                        <el-button type="primary" @click="addDomain">新增能力</el-button>
                                    </el-form-item>
                                </el-form>
                            </div>

                            <!--projectExperience-->
                            <div v-if="formIndex===3">
                                <h1>ProjectExperience</h1>
                                <el-form :model="resumeInfo.projectExperience" label-width="100px" class="demo-dynamic">
                                    <el-form-item v-for="(item, index) in resumeInfo.projectExperience" :key="index">
                                        <el-col :span="8">
                                            <el-form-item prop="name" label="项目名称">
                                                <el-input v-model="item.name"></el-input>
                                            </el-form-item>
                                        </el-col>
                                        <el-col :span="8">
                                            <el-form-item label="description">
                                                <el-input type="textarea" placeholder="description"
                                                          v-model="item.description"
                                                          maxlength="300" show-word-limit></el-input>
                                            </el-form-item>
                                        </el-col>
                                        <el-col :span="2" style="margin-left: 4rem">
                                            <el-button type="danger" @click.prevent="removeDomain(item)">删除</el-button>
                                        </el-col>
                                    </el-form-item>
                                    <el-form-item>
                                        <el-button type="primary" @click="addDomain">新增项目</el-button>
                                    </el-form-item>
                                </el-form>
                            </div>

                            <!--winnerHonor-->
                            <div v-if="formIndex===4">
                                <h1>WinnerHonor</h1>
                                <el-form :model="resumeInfo.winnerHonor" label-width="100px" class="demo-dynamic">
                                    <el-form-item v-for="(item, index) in resumeInfo.winnerHonor" :key="index">
                                        <el-col :span="8">
                                            <el-form-item prop="name" label="奖项类别">
                                                <el-input v-model="item.name"></el-input>
                                            </el-form-item>
                                        </el-col>
                                        <el-col :span="8">
                                            <el-form-item label="description">
                                                <el-input type="textarea" placeholder="description"
                                                          v-model="item.description"
                                                          maxlength="300" show-word-limit></el-input>
                                            </el-form-item>
                                        </el-col>
                                        <el-col :span="2" style="margin-left: 4rem">
                                            <el-button type="danger" @click.prevent="removeDomain(item)">删除</el-button>
                                        </el-col>
                                    </el-form-item>
                                    <el-form-item>
                                        <el-button type="primary" @click="addDomain">新增奖项</el-button>
                                    </el-form-item>
                                </el-form>
                            </div>

                            <!--personalProfile-->
                            <div v-if="formIndex===5">
                                <h1>PersonalProfile</h1>
                                <el-form :model="resumeInfo.personalProfile" label-width="100px" class="demo-dynamic">
                                    <el-form-item v-for="(item, index) in resumeInfo.personalProfile" :key="index">
                                        <el-col :span="8">
                                            <el-form-item prop="name" label="name">
                                                <el-input v-model="item.name"></el-input>
                                            </el-form-item>
                                        </el-col>
                                        <el-col :span="8">
                                            <el-form-item label="description">
                                                <el-input type="textarea" placeholder="description"
                                                          v-model="item.description"
                                                          maxlength="300" show-word-limit></el-input>
                                            </el-form-item>
                                        </el-col>
                                        <el-col :span="2" style="margin-left: 4rem">
                                            <el-button type="danger" @click.prevent="removeDomain(item)">删除</el-button>
                                        </el-col>
                                    </el-form-item>
                                    <el-form-item>
                                        <el-button type="primary" @click="addDomain">新增自评</el-button>
                                        <el-button type="success" @click="uploadResume">提交</el-button>
                                    </el-form-item>
                                </el-form>
                            </div>
                        </el-carousel-item>
                    </el-carousel>
                </el-main>
            </el-container>
        </el-container>
    </div>
</body>
<script src="/lib/js/vue.js"></script>
<script src="/lib/js/elementUI_index.js"></script>
<script src="/lib/js/axios.min.js"></script>
<script>
    let app = new Vue({
        el: "#app",
        data: {
            //进度条
            progressBar: {
                percentage: 0,
                customColor: '#409eff',
                customColors: [
                    {color: '#f56c6c', percentage: 20},
                    {color: '#e6a23c', percentage: 40},
                    {color: '#5cb87a', percentage: 60},
                    {color: '#1989fa', percentage: 80},
                    {color: '#6f7ad3', percentage: 100}
                ]
            },
            //表单索引
            formIndex: 0,
            //简历表单
            resumeInfo: {
                //用户信息
                user:{},
                //基础信息
                basicInfo: {
                    name: "",
                    job_profile: "",
                    phone: "",
                    email: "",
                    address: "",
                    national: "",
                    gender: "",
                    native_place: "",
                    age: "",
                    img: "/lib/img/login_bg.jpg"
                },
                //教育经历
                educationInfo: {
                    school: "",
                    profession: "",
                    learning_record: "",
                    learning_time: "",
                    profile: "",
                },
                //个人能力
                personalAbility: [
                    {
                        name: "",
                        description: ""
                    },
                ],
                //项目经历
                projectExperience: [
                    {
                        name: "",
                        description: ""
                    },
                ],
                //获奖荣誉
                winnerHonor: [
                    {
                        name: "",
                        description: ""
                    },
                ],
                //自我评价
                personalProfile: [
                    {
                        name: "",
                        description: ""
                    },
                ],
            },
        },

        created(){
            this.getUserInfo();
        },

        methods: {
            //获取当前用户的信息
            getUserInfo:function(){
                axios.get("/user").then((res)=>{
                    if(res.data.flag){
                        this.$message.success(res.data.msg);
                        this.resumeInfo.user=res.data.data;
                    }
                    else
                        this.$message.error(res.data.msg);
                });
            },

            //切换表单
            changeProgress: function (info) {
                this.progressBar.percentage = info*20;
                this.formIndex = info;
            },

            //添加域：PersonalAbility
            addDomain:function (){
                switch (this.formIndex){
                    case 2:{
                        this.resumeInfo.personalAbility.push({"name":"","description":""});
                        break;
                    }
                    case 3:{
                        this.resumeInfo.projectExperience.push({"name":"","description":""});
                        break;
                    }
                    case 4:{
                        this.resumeInfo.winnerHonor.push({"name":"","description":""});
                        break;
                    }
                    case 5:{
                        this.resumeInfo.personalProfile.push({"name":"","description":""});
                        break;
                    }
                }
            },

            //删除域：PersonalAbility
            removeDomain:function (item){
                switch (this.formIndex){
                    case 2:{
                        let index = this.resumeInfo.personalAbility.indexOf(item);
                        if (index !== 0)
                            this.resumeInfo.personalAbility.splice(index, 1);
                        break;
                    }
                    case 3:{
                        let index = this.resumeInfo.projectExperience.indexOf(item);
                        if (index !== 0)
                            this.resumeInfo.projectExperience.splice(index, 1);
                        break;
                    }
                    case 4:{
                        let index = this.resumeInfo.winnerHonor.indexOf(item);
                        if (index !== 0)
                            this.resumeInfo.winnerHonor.splice(index, 1);
                        break;
                    }
                    case 5:{
                        let index = this.resumeInfo.personalProfile.indexOf(item);
                        if (index !== 0)
                            this.resumeInfo.personalProfile.splice(index, 1);
                        break;
                    }
                }
            },

            //上传简历信息
            uploadResume:function(){
                axios.post("/resume/upload",this.resumeInfo).then((res)=>{
                    if(res.data.flag) {
                        this.$message.success(res.data.msg);
                        setTimeout(location.href="/resume.html",2000);
                    }
                    else
                        this.$message.error(res.data.msg);
                });
            },
        },
    });
</script>
</html>